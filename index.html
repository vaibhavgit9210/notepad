<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notepad</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="logo">Notepad</h1>
            <nav class="nav">
                <button id="btn-new" class="btn">New</button>
                <button id="btn-open" class="btn">Open</button>
                <button id="btn-save" class="btn btn-primary">Save</button>
            </nav>
        </header>

        <!-- Status Bar -->
        <div class="status-bar">
            <span id="status-text">Ready</span>
            <span id="autosave-indicator"></span>
        </div>

        <!-- Editor -->
        <main class="editor-container">
            <textarea id="editor" class="editor" placeholder="Start typing..."></textarea>
        </main>

        <!-- Note Title Input -->
        <div class="title-bar">
            <input type="text" id="note-title" class="note-title-input" placeholder="Untitled" maxlength="50">
        </div>
    </div>

    <!-- Auth Modal (GitHub Token) -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <h2>Setup</h2>
            <p>Enter your GitHub Personal Access Token to enable saving.</p>
            <form id="auth-form">
                <input type="password" id="github-token" placeholder="ghp_xxxxxxxxxxxx" required>
                <p class="hint">Token needs <code>repo</code> scope. <a href="https://github.com/settings/tokens/new" target="_blank">Create token</a></p>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Connect</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Password Setup Modal -->
    <div id="password-setup-modal" class="modal">
        <div class="modal-content">
            <h2>Set Password</h2>
            <p>Create a 6-digit code to protect your notes.</p>
            <form id="password-setup-form">
                <input type="password" id="new-password" placeholder="000000" maxlength="6" pattern="[0-9]{6}" inputmode="numeric" required>
                <input type="password" id="confirm-password" placeholder="Confirm code" maxlength="6" pattern="[0-9]{6}" inputmode="numeric" required>
                <p class="error-text" id="password-setup-error"></p>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">Set Password</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Password Entry Modal -->
    <div id="password-modal" class="modal">
        <div class="modal-content">
            <h2>Enter Password</h2>
            <p>Enter your 6-digit code to access notes.</p>
            <form id="password-form">
                <input type="password" id="password-input" placeholder="000000" maxlength="6" pattern="[0-9]{6}" inputmode="numeric" required>
                <p class="error-text" id="password-error"></p>
                <p class="attempts-text" id="attempts-remaining"></p>
                <div class="modal-actions">
                    <button type="button" id="btn-forgot" class="btn btn-link">Forgot Password</button>
                    <button type="submit" class="btn btn-primary">Unlock</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Lockout Modal -->
    <div id="lockout-modal" class="modal">
        <div class="modal-content">
            <h2>Locked Out</h2>
            <p>Too many incorrect attempts.</p>
            <p class="lockout-timer">Try again in <span id="lockout-time">60:00</span></p>
            <div class="modal-actions">
                <button type="button" id="btn-forgot-lockout" class="btn btn-link">Forgot Password</button>
            </div>
        </div>
    </div>

    <!-- Notes List Modal -->
    <div id="notes-modal" class="modal">
        <div class="modal-content modal-wide">
            <h2>Saved Notes</h2>
            <div id="notes-list" class="notes-list"></div>
            <div class="modal-actions">
                <button type="button" id="btn-close-notes" class="btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgot-modal" class="modal">
        <div class="modal-content">
            <h2>Reset Password</h2>
            <p>A reset code will be sent to your email.</p>
            <div class="modal-actions">
                <button type="button" id="btn-cancel-forgot" class="btn">Cancel</button>
                <button type="button" id="btn-send-reset" class="btn btn-primary">Send Code</button>
            </div>
            <p class="success-text" id="forgot-success"></p>
            <p class="error-text" id="forgot-error"></p>
        </div>
    </div>

    <!-- Reset Code Modal -->
    <div id="reset-modal" class="modal">
        <div class="modal-content">
            <h2>Enter Reset Code</h2>
            <p>Enter the code sent to your email.</p>
            <form id="reset-form">
                <input type="text" id="reset-code-input" placeholder="Enter code" required>
                <input type="password" id="new-password-reset" placeholder="New 6-digit code" maxlength="6" pattern="[0-9]{6}" inputmode="numeric" required>
                <p class="error-text" id="reset-error"></p>
                <div class="modal-actions">
                    <button type="button" id="btn-cancel-reset" class="btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Reset</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirm Dialog -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content">
            <h2 id="confirm-title">Confirm</h2>
            <p id="confirm-message"></p>
            <div class="modal-actions">
                <button type="button" id="btn-confirm-cancel" class="btn">Cancel</button>
                <button type="button" id="btn-confirm-ok" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/github-api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/email.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
